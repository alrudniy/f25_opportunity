{% extends "base.html" %}

{% block extra_css %}
<style>
    /* Basic dark theme for demonstration */
    [data-theme="dark"] {
        background-color: #222;
        color: #eee;
    }
    [data-theme="dark"] a {
        color: #9bf;
    }
    [data-theme="dark"] input, [data-theme="dark"] button {
        background-color: #333;
        color: #eee;
        border-color: #555;
    }
</style>
{% endblock %}


{% block content %}
<h2>User Settings</h2>
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Save Settings</button>
</form>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const themeRadios = document.querySelectorAll('input[name="theme"]');
        
        function setTheme(mode) {
            if (mode !== "light" && mode !== "dark" && mode !== "auto") {
                mode = "auto";
            }

            let effectiveTheme = mode;
            if (mode === "auto") {
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                effectiveTheme = prefersDark ? 'dark' : 'light';
            }
            
            document.documentElement.dataset.theme = effectiveTheme;
        }

        themeRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                setTheme(this.value);
            });
        });

        const currentThemeRadio = document.querySelector('input[name="theme"]:checked');
        if (currentThemeRadio) {
            setTheme(currentThemeRadio.value);
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            const currentThemeRadio = document.querySelector('input[name="theme"]:checked');
            if (currentThemeRadio && currentThemeRadio.value === 'auto') {
                setTheme('auto');
            }
        });
    });
</script>
{% endblock %}
